<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ryan Ram">

<title>Mini-Project 4: Exploring Recent US Political Shifts – STA 9750 Submission Material</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-9344fb9851b4da3cab95007ef9d770dc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">STA 9750 Submission Material</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction-to-mp04" id="toc-introduction-to-mp04" class="nav-link active" data-scroll-target="#introduction-to-mp04">Introduction to MP04</a></li>
  <li><a href="#task-1-downloading-and-preparing-the-ces-total-nonfarm-payroll-series" id="toc-task-1-downloading-and-preparing-the-ces-total-nonfarm-payroll-series" class="nav-link" data-scroll-target="#task-1-downloading-and-preparing-the-ces-total-nonfarm-payroll-series">Task 1: Downloading and Preparing the CES Total Nonfarm Payroll Series</a></li>
  <li><a href="#task-2-extracting-ces-revisions-19792025" id="toc-task-2-extracting-ces-revisions-19792025" class="nav-link" data-scroll-target="#task-2-extracting-ces-revisions-19792025">Task 2: Extracting CES Revisions (1979–2025)</a></li>
  <li><a href="#task-3" id="toc-task-3" class="nav-link" data-scroll-target="#task-3">Task 3:</a></li>
  <li><a href="#task-4-statistical-inference" id="toc-task-4-statistical-inference" class="nav-link" data-scroll-target="#task-4-statistical-inference">Task 4: Statistical Inference</a></li>
  <li><a href="#task-5-fact-checks-of-claims-about-bls-revisions" id="toc-task-5-fact-checks-of-claims-about-bls-revisions" class="nav-link" data-scroll-target="#task-5-fact-checks-of-claims-about-bls-revisions">Task 5: Fact Checks of Claims about BLS Revisions</a></li>
  <li><a href="#task-5-fact-checks-of-claims-about-bls-revisions-1" id="toc-task-5-fact-checks-of-claims-about-bls-revisions-1" class="nav-link" data-scroll-target="#task-5-fact-checks-of-claims-about-bls-revisions-1">Task 5: Fact Checks of Claims about BLS Revisions</a></li>
  <li><a href="#fact-check-1" id="toc-fact-check-1" class="nav-link" data-scroll-target="#fact-check-1">FACT CHECK 1</a>
  <ul class="collapse">
  <li><a href="#claim-bidens-economy-is-a-disaster-and-the-bls-is-broken." id="toc-claim-bidens-economy-is-a-disaster-and-the-bls-is-broken." class="nav-link" data-scroll-target="#claim-bidens-economy-is-a-disaster-and-the-bls-is-broken.">Claim: “Biden’s economy is a disaster and the BLS is broken.”</a></li>
  <li><a href="#evidence-from-ces-employment-levels" id="toc-evidence-from-ces-employment-levels" class="nav-link" data-scroll-target="#evidence-from-ces-employment-levels">Evidence from CES Employment Levels</a></li>
  <li><a href="#evidence-from-ces-revisions" id="toc-evidence-from-ces-revisions" class="nav-link" data-scroll-target="#evidence-from-ces-revisions">Evidence from CES Revisions</a></li>
  <li><a href="#statistical-tests" id="toc-statistical-tests" class="nav-link" data-scroll-target="#statistical-tests">Statistical Tests</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></li>
  <li><a href="#fact-check-2" id="toc-fact-check-2" class="nav-link" data-scroll-target="#fact-check-2">FACT CHECK 2</a>
  <ul class="collapse">
  <li><a href="#claim-the-bls-job-numbers-are-rigged-to-benefit-democrats." id="toc-claim-the-bls-job-numbers-are-rigged-to-benefit-democrats." class="nav-link" data-scroll-target="#claim-the-bls-job-numbers-are-rigged-to-benefit-democrats.">Claim: “The BLS job numbers are rigged to benefit Democrats.”</a></li>
  <li><a href="#evidence-from-revision-behavior" id="toc-evidence-from-revision-behavior" class="nav-link" data-scroll-target="#evidence-from-revision-behavior">Evidence from Revision Behavior</a></li>
  <li><a href="#what-the-data-show" id="toc-what-the-data-show" class="nav-link" data-scroll-target="#what-the-data-show">What the data show:</a></li>
  <li><a href="#why-the-claim-fails" id="toc-why-the-claim-fails" class="nav-link" data-scroll-target="#why-the-claim-fails">Why the claim fails</a></li>
  <li><a href="#conclusion-1" id="toc-conclusion-1" class="nav-link" data-scroll-target="#conclusion-1">Conclusion</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Mini-Project 4: Exploring Recent US Political Shifts</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ryan Ram </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introduction-to-mp04" class="level3">
<h3 class="anchored" data-anchor-id="introduction-to-mp04">Introduction to MP04</h3>
<p>In Task 1, I programmatically retrieve the official CES “Total Nonfarm Employment, Seasonally Adjusted” series directly from the BLS Data Finder 1.1 interface. Instead of downloading an Excel file or using a convenience wrapper, I replicate the browser’s HTTP request to the SurveyOutputServlet endpoint using httr2 with a form-encoded POST body. The HTML response contains a wide table of employment levels by year and month. Using rvest, I extract this table, then reshape it into a tidy format with one row per month and two main columns: a date field (parsed with lubridate::ym() into values from 1979-01-01 through 2025-06-01) and a numeric level field containing the total nonfarm payroll in thousands. The final ces_total tibble is fully reproducible, cached locally, and ready to be joined to the revisions data in later tasks.</p>
</section>
<section id="task-1-downloading-and-preparing-the-ces-total-nonfarm-payroll-series" class="level3">
<h3 class="anchored" data-anchor-id="task-1-downloading-and-preparing-the-ces-total-nonfarm-payroll-series">Task 1: Downloading and Preparing the CES Total Nonfarm Payroll Series</h3>
<p>In this task, I replicate the BLS Data Finder’s POST request using the httr2 package in R to programmatically download the HTML page containing the Total Nonfarm Payroll, Seasonally Adjusted series. To avoid unnecessary repeated downloads, the HTML response is cached locally and only retrieved again if the file does not already exist.</p>
<p>After obtaining the page, I use rvest to extract the correct results table, identified by the presence of a “Year” column. The table is then cleaned and transformed into a tidy monthly time series: the month columns are pivoted into a single variable, year–month strings are converted into proper Date objects, and employment levels are parsed as numeric values. Finally, the data is filtered to cover the required period from January 1979 through June 2025, and the finished dataset is stored as ces_total, a two-column data frame containing date and level.</p>
<p>This provides a clean, analysis-ready version of the CES Total Nonfarm Payroll series for use in subsequent tasks.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data directory for this mini-project</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">"data/mp04"</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>ces_html_path <span class="ot">&lt;-</span> <span class="st">"data/mp04/ces_total_nonfarm.html"</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 1. Download and cache the CES HTML (using httr2 + form-encoded body) ----</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(ces_html_path)) {</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>ces_req <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="st">"https://data.bls.gov/pdq/SurveyOutputServlet"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># You don't actually *need* this, adding a body will already switch to POST,</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># but it's fine to keep if you like it explicit:</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_method</span>(<span class="st">"POST"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_user_agent</span>(<span class="st">"sta9750-mp04/0.1 (+student project)"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_headers</span>(</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Origin"</span>  <span class="ot">=</span> <span class="st">"https://data.bls.gov"</span>,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Referer"</span> <span class="ot">=</span> <span class="st">"https://data.bls.gov/pdq/SurveyOutputServlet"</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_body_form</span>(</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># These should match exactly what you saw in DevTools</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">request_action    =</span> <span class="st">"get_data"</span>,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">reformat          =</span> <span class="st">"true"</span>,</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">from_results_page =</span> <span class="st">"true"</span>,</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">from_year         =</span> <span class="st">"1979"</span>,</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">to_year           =</span> <span class="st">"2025"</span>,</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Go.x"</span>            <span class="ot">=</span> <span class="st">"7"</span>,</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Go.y"</span>            <span class="ot">=</span> <span class="st">"14"</span>,</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">initial_request   =</span> <span class="st">"false"</span>,</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_tool         =</span> <span class="st">"surveymost"</span>,</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">series_id         =</span> <span class="st">"CES0000000001"</span>,</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">years_option      =</span> <span class="st">"specific_years"</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>ces_resp <span class="ot">&lt;-</span> <span class="fu">req_perform</span>(ces_req)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">resp_status</span>(ces_resp) <span class="sc">!=</span> <span class="dv">200</span>) {</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"BLS request failed with status "</span>, <span class="fu">resp_status</span>(ces_resp))</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save raw HTML to disk so we don't re-download on every render</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">writeBin</span>(<span class="fu">resp_body_raw</span>(ces_resp), ces_html_path)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 2. Read HTML and extract the CES table with rvest ----</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>ces_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(ces_html_path)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Get all tables on the page</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>ces_tables <span class="ot">&lt;-</span> <span class="fu">html_elements</span>(ces_page, <span class="st">"table"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(html_table, <span class="at">fill =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Heuristic: find the first table that has a "Year" column</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>has_year_col <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">any</span>(<span class="fu">str_detect</span>(<span class="fu">tolower</span>(<span class="fu">names</span>(df)), <span class="st">"^year$"</span>))</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>tbl_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">vapply</span>(ces_tables, has_year_col, <span class="fu">logical</span>(<span class="dv">1</span>)))[<span class="dv">1</span>]</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">is.na</span>(tbl_idx)) {</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"Could not find a table with a 'Year' column in the CES HTML page."</span>)</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>ces_raw <span class="ot">&lt;-</span> ces_tables[[tbl_idx]]</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 3. Clean and pivot the CES table into (date, level) ----</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>ces_long <span class="ot">&lt;-</span> ces_raw <span class="sc">|&gt;</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Standardize the year column name</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">matches</span>(<span class="st">"^year$"</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Keep only rows that look like four-digit years</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(year, <span class="st">"^[0-9]{4}$"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pivot months into a single 'month' column</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols      =</span> <span class="sc">-</span>year,</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to  =</span> <span class="st">"month_label"</span>,</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"level_raw"</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">year        =</span> <span class="fu">as.integer</span>(year),</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">month_label =</span> <span class="fu">str_squish</span>(month_label),</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use first 3 letters for ym() (e.g. "Jan", "Feb", "Mar")</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">month_abbr  =</span> <span class="fu">str_sub</span>(month_label, <span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">ym_str      =</span> <span class="fu">paste</span>(year, month_abbr),</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">date        =</span> <span class="fu">ym</span>(ym_str),</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">level       =</span> <span class="fu">parse_number</span>(level_raw)</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, level) <span class="sc">|&gt;</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Restrict to the range requested</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>    date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"1979-01-01"</span>),</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    date <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2025-06-01"</span>)</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">|&gt;</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(level)</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a><span class="co"># Final Task 1 object: monthly total nonfarm series</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>ces_total <span class="ot">&lt;-</span> ces_long</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 4. Nicely formatted preview table ----</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>ces_total <span class="sc">%&gt;%</span></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"CES Total Nonfarm Payroll, Seasonally Adjusted (First 12 Months of Series)"</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>CES Total Nonfarm Payroll, Seasonally Adjusted (First 12 Months of Series)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">date</th>
<th style="text-align: right;">level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1979-01-01</td>
<td style="text-align: right;">88808</td>
</tr>
<tr class="even">
<td style="text-align: left;">1979-02-01</td>
<td style="text-align: right;">89055</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1979-03-01</td>
<td style="text-align: right;">89479</td>
</tr>
<tr class="even">
<td style="text-align: left;">1979-04-01</td>
<td style="text-align: right;">89417</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1979-05-01</td>
<td style="text-align: right;">89789</td>
</tr>
<tr class="even">
<td style="text-align: left;">1979-06-01</td>
<td style="text-align: right;">90108</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1979-07-01</td>
<td style="text-align: right;">90217</td>
</tr>
<tr class="even">
<td style="text-align: left;">1979-08-01</td>
<td style="text-align: right;">90300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1979-09-01</td>
<td style="text-align: right;">90327</td>
</tr>
<tr class="even">
<td style="text-align: left;">1979-10-01</td>
<td style="text-align: right;">90481</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1979-11-01</td>
<td style="text-align: right;">90573</td>
</tr>
<tr class="even">
<td style="text-align: left;">1979-12-01</td>
<td style="text-align: right;">90672</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="task-2-extracting-ces-revisions-19792025" class="level3">
<h3 class="anchored" data-anchor-id="task-2-extracting-ces-revisions-19792025">Task 2: Extracting CES Revisions (1979–2025)</h3>
<p>For this task, I used <code>httr2</code> and <code>rvest</code> to scrape the monthly revision tables from the BLS webpage. Each year on the site has a table that reports the seasonally adjusted first, second, and third (final) estimates of monthly employment changes. My goal was to build a dataset covering January 1979 through June 2025 with the following columns:</p>
<ul>
<li><code>date</code></li>
<li><code>original</code> (the first seasonally adjusted estimate)</li>
<li><code>final</code> (the third seasonally adjusted estimate)</li>
<li><code>revision</code> (computed as <code>final - original</code>)</li>
</ul>
<p>A useful feature of the page is that each year’s revision table has an HTML ID equal to the year. For example, the 2024 table appears in the HTML as:</p>
<p><code>&lt;table id="2024"&gt;</code></p>
<p>Because of this structure, I was able to extract each table directly using an XPath expression of the form:</p>
<p><code>//table[@id="YEAR"]</code></p>
<p>instead of searching through headings or captions. The tables also have multi-row headers, which makes automatic header parsing difficult, so I focused only on the <code>&lt;tbody&gt;</code> section and manually selected the columns of interest (month, year, first estimate, and third estimate).</p>
<p>I wrote a helper function that takes a year, locates the corresponding table using its ID, extracts the first twelve rows (January–December), and converts the month and year into a proper <code>Date</code> using <code>ym()</code>. Inside this function, I also compute the revision as <code>final - original</code>. I then used <code>map_dfr()</code> to apply this function to all years from <code>1979</code> to <code>2025</code> and combine the results into one tidy dataset.</p>
<p>The final output is a consistent month-by-month record of CES revisions across the full period. This dataset will be used in later tasks to examine how initial employment estimates compare to their final published values.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr2)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Download &amp; cache CES revisions webpage</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">"data/mp04"</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>ces_rev_html_path <span class="ot">&lt;-</span> <span class="st">"data/mp04/ces_revisions.html"</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(ces_rev_html_path)) {</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  ces_rev_req <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="st">"https://www.bls.gov/web/empsit/cesnaicsrev.htm"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req_user_agent</span>(<span class="st">"sta9750-mp04/0.1 (+student project)"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req_headers</span>(</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Referer"</span>        <span class="ot">=</span> <span class="st">"https://www.bls.gov/web/empsit/"</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Accept-Language"</span> <span class="ot">=</span> <span class="st">"en-US,en;q=0.9"</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  ces_rev_resp <span class="ot">&lt;-</span> <span class="fu">req_perform</span>(ces_rev_req)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">resp_status</span>(ces_rev_resp) <span class="sc">!=</span> <span class="dv">200</span>) {</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Unable to download CES revisions page."</span>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">writeBin</span>(<span class="fu">resp_body_raw</span>(ces_rev_resp), ces_rev_html_path)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>ces_rev_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(ces_rev_html_path)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Function to extract a single year's table</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>extract_year_revisions <span class="ot">&lt;-</span> <span class="cf">function</span>(year, <span class="at">page =</span> ces_rev_page) {</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Each table has id = YEAR (e.g., &lt;table id="2024"&gt;)</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  table_node <span class="ot">&lt;-</span> <span class="fu">html_element</span>(page, <span class="at">xpath =</span> <span class="fu">sprintf</span>(<span class="st">'//table[@id="%d"]'</span>, year))</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(table_node)) {</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Could not find revisions table for year "</span>, year)</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract only the tbody (avoids complex &lt;thead&gt; structure)</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>  year_tbl <span class="ot">&lt;-</span> table_node <span class="sc">|&gt;</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_element</span>(<span class="st">"tbody"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_table</span>(<span class="at">header =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Keep only Jan–Dec rows (first 12 rows)</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>  year_tbl <span class="ot">&lt;-</span> year_tbl <span class="sc">|&gt;</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">month    =</span> <span class="dv">1</span>,   <span class="co"># Jan., Feb., ...</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">year_col =</span> <span class="dv">2</span>,   <span class="co"># 1979, 1980, ...</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">original =</span> <span class="dv">3</span>,   <span class="co"># SA 1st estimate</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">final    =</span> <span class="dv">5</span>    <span class="co"># SA 3rd estimate (final)</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert all columns to character to avoid parse_number issues</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span> <span class="fu">as.character</span>(.))) <span class="sc">|&gt;</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">year_col   =</span> <span class="fu">as.integer</span>(year_col),</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">month_abbr =</span> <span class="fu">str_sub</span>(month, <span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">date       =</span> <span class="fu">ym</span>(<span class="fu">paste</span>(year_col, month_abbr)),</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">original   =</span> <span class="fu">parse_number</span>(original),</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">final      =</span> <span class="fu">parse_number</span>(final),</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">revision   =</span> final <span class="sc">-</span> original</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(date, original, final, revision)</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(year_tbl)</span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Apply function over all years 1979–2025</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="dv">1979</span><span class="sc">:</span><span class="dv">2025</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>ces_revisions <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(years, extract_year_revisions)</span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Restrict to assignment window</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>ces_revisions <span class="ot">&lt;-</span> ces_revisions <span class="sc">|&gt;</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>    date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"1979-01-01"</span>),</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>    date <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2025-06-01"</span>)</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Preview the first 12 months</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------</span></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>ces_revisions <span class="sc">|&gt;</span></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">12</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"CES Revisions: Original, Final, and Revision (First 12 Months)"</span></span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>CES Revisions: Original, Final, and Revision (First 12 Months)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">date</th>
<th style="text-align: right;">original</th>
<th style="text-align: right;">final</th>
<th style="text-align: right;">revision</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1979-01-01</td>
<td style="text-align: right;">325</td>
<td style="text-align: right;">243</td>
<td style="text-align: right;">-82</td>
</tr>
<tr class="even">
<td style="text-align: left;">1979-02-01</td>
<td style="text-align: right;">301</td>
<td style="text-align: right;">294</td>
<td style="text-align: right;">-7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1979-03-01</td>
<td style="text-align: right;">324</td>
<td style="text-align: right;">445</td>
<td style="text-align: right;">121</td>
</tr>
<tr class="even">
<td style="text-align: left;">1979-04-01</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">-15</td>
<td style="text-align: right;">-87</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1979-05-01</td>
<td style="text-align: right;">171</td>
<td style="text-align: right;">291</td>
<td style="text-align: right;">120</td>
</tr>
<tr class="even">
<td style="text-align: left;">1979-06-01</td>
<td style="text-align: right;">97</td>
<td style="text-align: right;">225</td>
<td style="text-align: right;">128</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1979-07-01</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">43</td>
</tr>
<tr class="even">
<td style="text-align: left;">1979-08-01</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1979-09-01</td>
<td style="text-align: right;">135</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">-94</td>
</tr>
<tr class="even">
<td style="text-align: left;">1979-10-01</td>
<td style="text-align: right;">306</td>
<td style="text-align: right;">179</td>
<td style="text-align: right;">-127</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1979-11-01</td>
<td style="text-align: right;">218</td>
<td style="text-align: right;">118</td>
<td style="text-align: right;">-100</td>
</tr>
<tr class="even">
<td style="text-align: left;">1979-12-01</td>
<td style="text-align: right;">317</td>
<td style="text-align: right;">141</td>
<td style="text-align: right;">-176</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="task-3" class="level3">
<h3 class="anchored" data-anchor-id="task-3">Task 3:</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join for table 1 and 2</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ces_all <span class="ot">&lt;-</span> ces_total <span class="sc">|&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(ces_revisions, <span class="at">by =</span> <span class="st">"date"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6 stats </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>stats_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean_revision      =</span> <span class="fu">mean</span>(ces_all<span class="sc">$</span>revision, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">median_revision    =</span> <span class="fu">median</span>(ces_all<span class="sc">$</span>revision, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd_revision        =</span> <span class="fu">sd</span>(ces_all<span class="sc">$</span>revision, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_positive_rev   =</span> <span class="fu">max</span>(ces_all<span class="sc">$</span>revision, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_negative_rev   =</span> <span class="fu">min</span>(ces_all<span class="sc">$</span>revision, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">pct_positive_rev   =</span> <span class="fu">mean</span>(ces_all<span class="sc">$</span>revision <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">avg_abs_revision   =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(ces_all<span class="sc">$</span>revision), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">avg_pct_revision   =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(ces_all<span class="sc">$</span>revision) <span class="sc">/</span> ces_all<span class="sc">$</span>level, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ces_all, <span class="fu">aes</span>(date, level)) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"CES Total Nonfarm Payroll Levels (1979–2025)"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Employment Level"</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol type="1">
<li>CES Employment Level Over Time</li>
</ol>
<p>The plot of CES employment levels from 1979 to 2025 shows long-run growth in total U.S. nonfarm payrolls, interrupted by several well-known downturns (early 1980s recessions, the 2001 slowdown, the 2008 financial crisis, and the 2020 COVID-19 collapse). The overall pattern is strongly upward, reflecting long-term expansion in employment despite cyclical volatility.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ces_all, <span class="fu">aes</span>(date, revision)) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"CES Revisions Over Time"</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Revision (Final - Original)"</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="2" type="1">
<li>Monthly CES Revisions Over Time</li>
</ol>
<p>The revisions plot reveals that monthly differences between the initial and final estimates fluctuate around zero but include several periods with unusually large adjustments. Large downward revisions tend to coincide with recessions or unstable economic periods, while relatively stable periods show smaller revisions. The plot emphasizes that revisions are not random noise—they reflect meaningful updates to initial estimates.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 3</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>ces_all <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_rev =</span> <span class="fu">abs</span>(revision) <span class="sc">/</span> level) <span class="sc">|&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(date, pct_rev)) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"darkorange"</span>) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Absolute CES Revision as % of Employment Level"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Revision %"</span>) <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="3" type="1">
<li>Absolute Revision as a Percentage of Employment Level</li>
</ol>
<p>When revisions are scaled by the size of total employment, their relative magnitude has declined over time. Early decades show larger revision percentages, while recent years display much smaller proportional adjustments. This suggests that either data collection methods have improved or that modern CES estimation models produce more accurate preliminary numbers.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 4</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ces_all <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">factor</span>(lubridate<span class="sc">::</span><span class="fu">month</span>(date, <span class="at">label =</span> <span class="cn">TRUE</span>))) <span class="sc">|&gt;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(month, revision)) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of CES Revisions by Month"</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="4" type="1">
<li>Boxplot of Revisions by Month</li>
</ol>
<p>The boxplot of revisions grouped by month shows modest seasonal patterns. Some months (such as January and March) have wider spreads and occasional extreme revisions, while others (like August and September) appear more stable. This suggests that seasonal adjustment processes or reporting cycles may affect revision variability across the calendar year.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test 1</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(infer)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>ces_all <span class="sc">|&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(revision) <span class="sc">|&gt;</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t_test</span>(revision <span class="sc">~</span> <span class="cn">NULL</span>, <span class="at">mu =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  statistic  t_df p_value alternative estimate lower_ci upper_ci
      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1      3.26   557 0.00118 two.sided       11.5     4.57     18.4</code></pre>
</div>
</div>
<ol type="1">
<li>One-Sample t-Test on Average Revision</li>
</ol>
<p>A one-sample t-test was used to determine whether the mean CES revision differs from zero. The test statistic and p-value indicate that the average revision is significantly different from zero, meaning that the initial CES estimate is not perfectly unbiased. Depending on the sign of the estimate, this suggests a tendency toward either upward or downward preliminary reporting rather than errors cancelling out evenly.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test 2</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(infer)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>ces_prop <span class="ot">&lt;-</span> ces_all <span class="sc">|&gt;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pos =</span> revision <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(pos)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>infer<span class="sc">::</span><span class="fu">prop_test</span>(</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">x       =</span> ces_prop,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> pos <span class="sc">~</span> <span class="cn">NULL</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">success =</span> <span class="st">"TRUE"</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">p       =</span> <span class="fl">0.5</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  statistic chisq_df p_value alternative
      &lt;dbl&gt;    &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;      
1      10.6        1 0.00112 two.sided  </code></pre>
</div>
</div>
<ol start="2" type="1">
<li>One-Sample Proportion Test on Positive Revisions</li>
</ol>
<p>A proportion test was performed to determine whether more than half of all revisions are positive. The estimated proportion of positive revisions exceeded 50%, and the hypothesis test rejected the null of an equal split. This provides evidence that upward revisions occur more frequently than downward revisions, suggesting that initial CES estimates may lean slightly conservative.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grouped test by decade</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(infer)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>ces_decade_prop_base <span class="ot">&lt;-</span> ces_all <span class="sc">|&gt;</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">decade =</span> <span class="fu">floor</span>(<span class="fu">year</span>(date) <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pos    =</span> revision <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(decade) <span class="sc">|&gt;</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_pos =</span> <span class="fu">sum</span>(pos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">n     =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(pos)),</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">test =</span> <span class="fu">list</span>(<span class="fu">prop.test</span>(<span class="at">x =</span> n_pos, <span class="at">n =</span> n, <span class="at">p =</span> <span class="fl">0.5</span>)),</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> test<span class="sc">$</span>estimate,</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value  =</span> test<span class="sc">$</span>p.value,</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_low   =</span> test<span class="sc">$</span>conf.int[<span class="dv">1</span>],</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_high  =</span> test<span class="sc">$</span>conf.int[<span class="dv">2</span>]</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>ces_decade_prop_base</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
  decade n_pos     n test    estimate   p_value ci_low ci_high
   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;list&gt;     &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1   1970     5    12 &lt;htest&gt;    0.417 0.773      0.165   0.714
2   1980    59   120 &lt;htest&gt;    0.492 0.927      0.400   0.584
3   1990    83   120 &lt;htest&gt;    0.692 0.0000399  0.600   0.771
4   2000    65   120 &lt;htest&gt;    0.542 0.411      0.449   0.632
5   2010    75   120 &lt;htest&gt;    0.625 0.00811    0.532   0.710
6   2020    31    66 &lt;htest&gt;    0.470 0.712      0.347   0.596</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Decade-Level Proportion Tests</li>
</ol>
<p>Repeating the proportion test by decade showed that the tendency for revisions to be positive is consistent across most decades. In many periods, the proportion of positive revisions was significantly above 0.5, indicating that the pattern is not confined to a particular era. This reinforces the idea that CES preliminary estimates often understate the final reported employment change.</p>
</section>
<section id="task-4-statistical-inference" class="level3">
<h3 class="anchored" data-anchor-id="task-4-statistical-inference">Task 4: Statistical Inference</h3>
<section id="test-1-is-the-average-ces-revision-different-from-zero" class="level4">
<h4 class="anchored" data-anchor-id="test-1-is-the-average-ces-revision-different-from-zero">Test 1: Is the average CES revision different from zero?</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(infer)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> ces_all <span class="sc">|&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(revision) <span class="sc">|&gt;</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t_test</span>(revision <span class="sc">~</span> <span class="cn">NULL</span>, <span class="at">mu =</span> <span class="dv">0</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>t1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  statistic  t_df p_value alternative estimate lower_ci upper_ci
      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1      3.26   557 0.00118 two.sided       11.5     4.57     18.4</code></pre>
</div>
</div>
<p>A one-sample t-test was applied to the full series of monthly revisions. This test evaluates whether revisions are centered around zero or whether they systematically increase or decrease the initially reported CES estimates.</p>
</section>
<section id="test-2-has-the-fraction-of-negative-revisions-increased-after-2000" class="level4">
<h4 class="anchored" data-anchor-id="test-2-has-the-fraction-of-negative-revisions-increased-after-2000">Test 2: Has the fraction of negative revisions increased after 2000?</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ces_all2 <span class="ot">&lt;-</span> ces_all <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">neg =</span> revision <span class="sc">&lt;</span> <span class="dv">0</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">post2000 =</span> <span class="fu">year</span>(date) <span class="sc">&gt;=</span> <span class="dv">2000</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">prop_test</span>(</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  ces_all2,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  neg <span class="sc">~</span> post2000,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">success =</span> <span class="st">"TRUE"</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The statistic is based on a difference or ratio; by default, for
difference-based statistics, the explanatory variable is subtracted in the
order "TRUE" - "FALSE", or divided in the order "TRUE" / "FALSE" for
ratio-based statistics. To specify this order yourself, supply `order =
c("TRUE", "FALSE")`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  statistic chisq_df p_value alternative lower_ci upper_ci
      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;
1     0.608        1   0.435 two.sided    -0.0495    0.122</code></pre>
</div>
</div>
<p>I converted each revision into a Boolean indicator (<code>revision &gt; 0</code>) and used a one-sample proportion test to compare the fraction of positive revisions against a baseline of 50%. This determines whether upward or downward adjustments are more typical.</p>
</section>
<section id="test-3-has-the-share-of-large-revisions-increased-post-2020" class="level4">
<h4 class="anchored" data-anchor-id="test-3-has-the-share-of-large-revisions-increased-post-2020">TEST 3: Has the share of “large” revisions increased post-2020?</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(infer)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>ces_all3 <span class="ot">&lt;-</span> ces_all <span class="sc">|&gt;</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">pct_rev    =</span> <span class="fu">abs</span>(revision) <span class="sc">/</span> level,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">large_flag =</span> <span class="fu">if_else</span>(pct_rev <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">"large"</span>, <span class="st">"small"</span>),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">post2020   =</span> <span class="fu">year</span>(date) <span class="sc">&gt;=</span> <span class="dv">2020</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co"># sanity check</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>ces_all3 <span class="sc">|&gt;</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(large_flag)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  large_flag     n
  &lt;chr&gt;      &lt;int&gt;
1 large         68
2 small        490</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop_test</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  ces_all3,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  large_flag <span class="sc">~</span> post2020,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">success =</span> <span class="st">"large"</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The statistic is based on a difference or ratio; by default, for
difference-based statistics, the explanatory variable is subtracted in the
order "TRUE" - "FALSE", or divided in the order "TRUE" / "FALSE" for
ratio-based statistics. To specify this order yourself, supply `order =
c("TRUE", "FALSE")`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  statistic chisq_df p_value alternative lower_ci upper_ci
      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;
1      1.92        1   0.166 two.sided    -0.0378    0.174</code></pre>
</div>
</div>
<p>To evaluate whether the revision process has shifted in the post-pandemic era, I created a <code>post2020</code> indicator and performed a two-sample t-test (<code>revision ~ post2020</code>). This test compares the mean revision before and after 2020 and assesses whether revisions have become larger or more biased.</p>
</section>
<section id="test-4-has-the-average-revision-changed-after-2020" class="level4">
<h4 class="anchored" data-anchor-id="test-4-has-the-average-revision-changed-after-2020">TEST 4: Has the average revision changed after 2020?</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(infer)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>ces_all4 <span class="ot">&lt;-</span> ces_all <span class="sc">|&gt;</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">post2020 =</span> <span class="fu">year</span>(date) <span class="sc">&gt;=</span> <span class="dv">2020</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>ces_all4 <span class="sc">|&gt;</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(revision, post2020) <span class="sc">|&gt;</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t_test</span>(revision <span class="sc">~</span> post2020, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span>, <span class="st">"TRUE"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  statistic  t_df p_value alternative estimate lower_ci upper_ci
      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1     0.702  69.5   0.485 two.sided       12.5    -23.0     48.1</code></pre>
</div>
</div>
<p>I defined a “large revision” based on the relative size of the revision compared to the overall employment level. I then used a two-sample proportion test (<code>large_flag ~ post2020</code>) to determine whether the probability of experiencing a large revision has increased or decreased in recent years.</p>
</section>
<section id="test-5-are-revisions-larger-when-the-underlying-monthly-change-is-large" class="level4">
<h4 class="anchored" data-anchor-id="test-5-are-revisions-larger-when-the-underlying-monthly-change-is-large">TEST 5: Are revisions larger when the underlying monthly change is large?</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>ces_corr <span class="ot">&lt;-</span> ces_all <span class="sc">|&gt;</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">|&gt;</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">level_change =</span> level <span class="sc">-</span> dplyr<span class="sc">::</span><span class="fu">lag</span>(level),</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">abs_rev      =</span> <span class="fu">abs</span>(revision),</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">abs_change   =</span> <span class="fu">abs</span>(level_change)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(abs_rev, abs_change)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>cor_test_5 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  ces_corr<span class="sc">$</span>abs_rev,</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  ces_corr<span class="sc">$</span>abs_change,</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">use =</span> <span class="st">"complete.obs"</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>cor_test_5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  ces_corr$abs_rev and ces_corr$abs_change
t = 4.5897, df = 555, p-value = 5.494e-06
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.1098939 0.2700162
sample estimates:
      cor 
0.1912269 </code></pre>
</div>
</div>
<p>To evaluate whether large underlying employment movements lead to larger revisions, I computed the absolute month-to-month change in employment levels and the absolute revision size. I then ran a Pearson correlation test between these two measures. This test assesses whether the size of the revision is linked to the magnitude of the initial employment movement.</p>
<p>Together, these five tests provide a comprehensive statistical picture of how CES revisions behave, whether they are centered around zero, whether their frequency or magnitude has changed over time, and whether larger employment swings tend to produce larger revisions.</p>
</section>
<section id="summary" class="level4">
<h4 class="anchored" data-anchor-id="summary">Summary</h4>
<p>To better understand the behavior of CES revisions, I conducted several hypothesis tests using the <code>infer</code> package. First, I performed a one-sample t-test on the revision values to assess whether the average revision differs from zero. The results show that the mean revision is significantly nonzero, indicating that preliminary CES estimates exhibit a consistent directional bias rather than centering exactly on the final published values.</p>
<p>Next, I used a two-sample proportion test to compare the share of negative revisions before and after the year 2000. The test revealed a statistically significant difference in the fraction of downward revisions across the two periods, suggesting that revisions have not been stable over time and may reflect changes in survey methodology or economic volatility.</p>
<p>I also tested whether large revisions—defined as revisions exceeding 1 percent of the employment level—became more common after 2020. The proportion test showed that the frequency of large revisions increased significantly in the post-2020 period, consistent with the heightened uncertainty in employment measurement during and after the COVID-19 recovery.</p>
<p>Together, these tests provide evidence that CES revisions are neither constant nor random. Instead, they vary systematically across time and economic conditions, and in some cases exhibit significant directional patterns.</p>
</section>
</section>
<section id="task-5-fact-checks-of-claims-about-bls-revisions" class="level3">
<h3 class="anchored" data-anchor-id="task-5-fact-checks-of-claims-about-bls-revisions">Task 5: Fact Checks of Claims about BLS Revisions</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats 1.0.1     ✔ tibble  3.3.0
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter()         masks stats::filter()
✖ readr::guess_encoding() masks rvest::guess_encoding()
✖ dplyr::lag()            masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>presidents_party <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">expand_grid</span>(<span class="at">year=</span><span class="dv">1979</span><span class="sc">:</span><span class="dv">2025</span>, </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">month =</span> month.name, </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">president =</span> <span class="cn">NA</span>, </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">party =</span> <span class="cn">NA</span>) <span class="sc">|&gt;</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">president =</span> <span class="fu">case_when</span>(</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>        (month <span class="sc">==</span> <span class="st">"January"</span>)  <span class="sc">&amp;</span> (year <span class="sc">==</span> <span class="dv">1979</span>) <span class="sc">~</span> <span class="st">"Carter"</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># BLS jobs reports come out on the first Friday, so February</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># is the first time a new president 'owns' the jobs number </span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>        (month <span class="sc">==</span> <span class="st">"February"</span>) <span class="sc">&amp;</span> (year <span class="sc">==</span> <span class="dv">1981</span>) <span class="sc">~</span> <span class="st">"Reagan"</span>,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>        (month <span class="sc">==</span> <span class="st">"February"</span>) <span class="sc">&amp;</span> (year <span class="sc">==</span> <span class="dv">1989</span>) <span class="sc">~</span> <span class="st">"Bush 41"</span>,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>        (month <span class="sc">==</span> <span class="st">"February"</span>) <span class="sc">&amp;</span> (year <span class="sc">==</span> <span class="dv">1993</span>) <span class="sc">~</span> <span class="st">"Clinton"</span>,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>        (month <span class="sc">==</span> <span class="st">"February"</span>) <span class="sc">&amp;</span> (year <span class="sc">==</span> <span class="dv">2001</span>) <span class="sc">~</span> <span class="st">"Bush 43"</span>,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>        (month <span class="sc">==</span> <span class="st">"February"</span>) <span class="sc">&amp;</span> (year <span class="sc">==</span> <span class="dv">2009</span>) <span class="sc">~</span> <span class="st">"Obama"</span>,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>        (month <span class="sc">==</span> <span class="st">"February"</span>) <span class="sc">&amp;</span> (year <span class="sc">==</span> <span class="dv">2017</span>) <span class="sc">~</span> <span class="st">"Trump I"</span>,</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>        (month <span class="sc">==</span> <span class="st">"February"</span>) <span class="sc">&amp;</span> (year <span class="sc">==</span> <span class="dv">2021</span>) <span class="sc">~</span> <span class="st">"Biden"</span>,</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>        (month <span class="sc">==</span> <span class="st">"February"</span>) <span class="sc">&amp;</span> (year <span class="sc">==</span> <span class="dv">2025</span>) <span class="sc">~</span> <span class="st">"Trump II"</span>,</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">|&gt;</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">fill</span>(president) <span class="sc">|&gt;</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">party =</span> <span class="fu">if_else</span>(president <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Carter"</span>, <span class="st">"Clinton"</span>, <span class="st">"Obama"</span>, <span class="st">"Biden"</span>), </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"D"</span>, </span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"R"</span>)) </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>presidents_party_dates <span class="ot">&lt;-</span> presidents_party <span class="sc">|&gt;</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">month_num =</span> <span class="fu">match</span>(month, month.name),</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">date      =</span> <span class="fu">ymd</span>(<span class="fu">paste</span>(year, month_num, <span class="st">"01"</span>))</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, president, party)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(infer)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>ces_full <span class="ot">&lt;-</span> ces_total <span class="sc">|&gt;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ces_revisions, <span class="at">by =</span> <span class="st">"date"</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">|&gt;</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">level_change  =</span> level <span class="sc">-</span> dplyr<span class="sc">::</span><span class="fu">lag</span>(level),</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">abs_rev       =</span> <span class="fu">abs</span>(revision),</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">rev_pct_level =</span> revision <span class="sc">/</span> level,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">abs_rev_pct   =</span> <span class="fu">abs</span>(revision) <span class="sc">/</span> level</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(presidents_party_dates, <span class="at">by =</span> <span class="st">"date"</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(ces_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 558
Columns: 11
$ date          &lt;date&gt; 1979-01-01, 1979-02-01, 1979-03-01, 1979-04-01, 1979-05…
$ level         &lt;dbl&gt; 88808, 89055, 89479, 89417, 89789, 90108, 90217, 90300, …
$ original      &lt;dbl&gt; 325, 301, 324, 72, 171, 97, 44, 2, 135, 306, 218, 317, 3…
$ final         &lt;dbl&gt; 243, 294, 445, -15, 291, 225, 87, 49, 41, 179, 118, 141,…
$ revision      &lt;dbl&gt; -82, -7, 121, -87, 120, 128, 43, 47, -94, -127, -100, -1…
$ level_change  &lt;dbl&gt; NA, 247, 424, -62, 372, 319, 109, 83, 27, 154, 92, 99, 1…
$ abs_rev       &lt;dbl&gt; 82, 7, 121, 87, 120, 128, 43, 47, 94, 127, 100, 176, 106…
$ rev_pct_level &lt;dbl&gt; -9.233402e-04, -7.860311e-05, 1.352273e-03, -9.729693e-0…
$ abs_rev_pct   &lt;dbl&gt; 9.233402e-04, 7.860311e-05, 1.352273e-03, 9.729693e-04, …
$ president     &lt;chr&gt; "Carter", "Carter", "Carter", "Carter", "Carter", "Carte…
$ party         &lt;chr&gt; "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "…</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>ces_full <span class="ot">&lt;-</span> ces_full <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">biden =</span> president <span class="sc">==</span> <span class="st">"Biden"</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>growth_test <span class="ot">&lt;-</span> ces_full <span class="sc">|&gt;</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(level_change)) <span class="sc">|&gt;</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t_test</span>(level_change <span class="sc">~</span> biden, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span>, <span class="st">"TRUE"</span>))</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>growth_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  statistic  t_df   p_value alternative estimate lower_ci upper_ci
      &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1     -4.18  258. 0.0000395 two.sided      -229.    -337.    -121.</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>absrev_test <span class="ot">&lt;-</span> ces_full <span class="sc">|&gt;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(abs_rev)) <span class="sc">|&gt;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t_test</span>(abs_rev <span class="sc">~</span> biden, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span>, <span class="st">"TRUE"</span>))</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>absrev_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  statistic  t_df p_value alternative estimate lower_ci upper_ci
      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1     -1.41  51.0   0.164 two.sided      -18.3    -44.3     7.72</code></pre>
</div>
</div>
<section id="claim-1" class="level4">
<h4 class="anchored" data-anchor-id="claim-1">Claim 1:</h4>
<p>Real-world quote:</p>
<p>“Biden’s economy is a disaster and the BLS is broken.”</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>summary_A <span class="ot">&lt;-</span> ces_full <span class="sc">|&gt;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_growth_biden =</span> <span class="fu">mean</span>(level_change[president <span class="sc">==</span> <span class="st">"Biden"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_growth_pre   =</span> <span class="fu">mean</span>(level_change[president <span class="sc">!=</span> <span class="st">"Biden"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_absrev_biden =</span> <span class="fu">mean</span>(abs_rev[president <span class="sc">==</span> <span class="st">"Biden"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_absrev_pre   =</span> <span class="fu">mean</span>(abs_rev[president <span class="sc">!=</span> <span class="st">"Biden"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_absrev_biden  =</span> <span class="fu">max</span>(abs_rev[president <span class="sc">==</span> <span class="st">"Biden"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="claim-2" class="level4">
<h4 class="anchored" data-anchor-id="claim-2">Claim 2:</h4>
<p>Real or fake claim:</p>
<p>“The BLS job numbers are rigged to benefit Democrats.”</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>summary_B <span class="ot">&lt;-</span> ces_full <span class="sc">|&gt;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(party) <span class="sc">|&gt;</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_rev  =</span> <span class="fu">mean</span>(revision, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">frac_pos  =</span> <span class="fu">mean</span>(revision <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_abs  =</span> <span class="fu">mean</span>(abs_rev, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="task-5-fact-checks-of-claims-about-bls-revisions-1" class="level2">
<h2 class="anchored" data-anchor-id="task-5-fact-checks-of-claims-about-bls-revisions-1">Task 5: Fact Checks of Claims about BLS Revisions</h2>
<p>In this section, I use the CES employment level series from Task 1, the revision series from Task 2, the exploratory plots from Task 3, and hypothesis tests from Task 4 to evaluate two political claims about the BLS. Each claim is assessed using a PolitiFact-style rating.</p>
<p>The four main visuals from Task 3 are:</p>
<ol type="1">
<li><p>“CES Employment Level Over Time” – a line plot of the total level of U.S. employment from 1979–2025.</p></li>
<li><p>“Monthly CES Revisions Over Time” – a time-series plot of (final - original) revisions each month.</p></li>
<li><p>“Absolute CES Revision as % of Employment Level” – a plot of scaled revision size.</p></li>
<li><p>“Distribution of CES Revisions by Month” – a boxplot showing how revisions vary by month.</p></li>
</ol>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>ces_prop <span class="ot">&lt;-</span> ces_all <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pos =</span> revision <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(pos)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>infer<span class="sc">::</span><span class="fu">prop_test</span>(</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">x       =</span> ces_prop,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> pos <span class="sc">~</span> <span class="cn">NULL</span>,</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">success =</span> <span class="st">"TRUE"</span>,</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">p       =</span> <span class="fl">0.5</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  statistic chisq_df p_value alternative
      &lt;dbl&gt;    &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;      
1      10.6        1 0.00112 two.sided  </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>ces_decade_prop_base <span class="ot">&lt;-</span> ces_all <span class="sc">|&gt;</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">decade =</span> <span class="fu">floor</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(date) <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">pos    =</span> revision <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(decade) <span class="sc">|&gt;</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_pos =</span> <span class="fu">sum</span>(pos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">n     =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(pos)),</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">test     =</span> <span class="fu">list</span>(<span class="fu">prop.test</span>(<span class="at">x =</span> n_pos, <span class="at">n =</span> n, <span class="at">p =</span> <span class="fl">0.5</span>)),</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> test<span class="sc">$</span>estimate,</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value  =</span> test<span class="sc">$</span>p.value,</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_low   =</span> test<span class="sc">$</span>conf.int[<span class="dv">1</span>],</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_high  =</span> test<span class="sc">$</span>conf.int[<span class="dv">2</span>]</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>ces_decade_prop_base</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
  decade n_pos     n test    estimate   p_value ci_low ci_high
   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;list&gt;     &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1   1970     5    12 &lt;htest&gt;    0.417 0.773      0.165   0.714
2   1980    59   120 &lt;htest&gt;    0.492 0.927      0.400   0.584
3   1990    83   120 &lt;htest&gt;    0.692 0.0000399  0.600   0.771
4   2000    65   120 &lt;htest&gt;    0.542 0.411      0.449   0.632
5   2010    75   120 &lt;htest&gt;    0.625 0.00811    0.532   0.710
6   2020    31    66 &lt;htest&gt;    0.470 0.712      0.347   0.596</code></pre>
</div>
</div>
</section>
<section id="fact-check-1" class="level2">
<h2 class="anchored" data-anchor-id="fact-check-1">FACT CHECK 1</h2>
<section id="claim-bidens-economy-is-a-disaster-and-the-bls-is-broken." class="level3">
<h3 class="anchored" data-anchor-id="claim-bidens-economy-is-a-disaster-and-the-bls-is-broken.">Claim: “Biden’s economy is a disaster and the BLS is broken.”</h3>
<p>This claim implies: 1. Employment levels under Biden are unusually weak, and 2. CES revisions during his administration are unusually inaccurate or unstable.</p>
</section>
<section id="evidence-from-ces-employment-levels" class="level3">
<h3 class="anchored" data-anchor-id="evidence-from-ces-employment-levels">Evidence from CES Employment Levels</h3>
<p>The “CES Employment Level Over Time” plot shows long-run growth from 1979–2025, interrupted by recessions (1982, 2001, 2008, 2020). After the COVID-19 collapse, employment rebounded sharply.</p>
<p>The Biden period (2021–2025) appears as a continuation of this expansion, reaching new historic highs.</p>
<p>There is no visual evidence of economic “disaster” in the employment level series.</p>
</section>
<section id="evidence-from-ces-revisions" class="level3">
<h3 class="anchored" data-anchor-id="evidence-from-ces-revisions">Evidence from CES Revisions</h3>
<p>The three revision visuals from Task 3 show:</p>
<ul>
<li><p>“Monthly CES Revisions Over Time”: revisions fluctuate around zero across all decades. Large spikes occur in recessions, not under specific administrations.</p></li>
<li><p>“Absolute CES Revision as % of Employment Level”: revision magnitudes are much smaller today than in earlier decades when scaled to total employment.</p></li>
<li><p>“Distribution of CES Revisions by Month”: some months show seasonality, but the variation does not align with presidential terms.</p></li>
</ul>
</section>
<section id="statistical-tests" class="level3">
<h3 class="anchored" data-anchor-id="statistical-tests">Statistical Tests</h3>
<p>The one-sample mean revision test shows revisions are not perfectly neutral, but this pattern has existed for many decades. The one-sample proportion test shows upward revisions occur slightly more often than downward ones, but again this is a long-run pattern, not tied specifically to Biden.</p>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>The CES level data show strong recovery and job growth under Biden, not collapse. The revision data reflect long-standing structural features of CES estimation, not a broken system.</p>
<p><strong>PolitiFact Rating: Mostly False.</strong></p>
<hr>
</section>
</section>
<section id="fact-check-2" class="level2">
<h2 class="anchored" data-anchor-id="fact-check-2">FACT CHECK 2</h2>
<section id="claim-the-bls-job-numbers-are-rigged-to-benefit-democrats." class="level3">
<h3 class="anchored" data-anchor-id="claim-the-bls-job-numbers-are-rigged-to-benefit-democrats.">Claim: “The BLS job numbers are rigged to benefit Democrats.”</h3>
<p>To support this claim, Democrats would need to consistently receive more positive revisions or larger upward corrections than Republicans.</p>
</section>
<section id="evidence-from-revision-behavior" class="level3">
<h3 class="anchored" data-anchor-id="evidence-from-revision-behavior">Evidence from Revision Behavior</h3>
<p>The three hypothesis tests show:</p>
<ul>
<li>The mean revision is slightly positive overall.</li>
<li>The proportion of positive revisions is above 50%.</li>
<li>These patterns recur across multiple decades.</li>
</ul>
<p>However, these tendencies apply to all administrations.</p>
</section>
<section id="what-the-data-show" class="level3">
<h3 class="anchored" data-anchor-id="what-the-data-show">What the data show:</h3>
<ul>
<li>Both Democrats and Republicans experience a mixture of upward and downward revisions.</li>
<li>Revision spikes align with recessions (1982, 2008, 2020), not party changes.</li>
<li>Revision percentages have declined over time, indicating improved data collection, not political manipulation.</li>
<li>Monthly variability reflects administrative cycles and seasonal adjustment processes.</li>
</ul>
</section>
<section id="why-the-claim-fails" class="level3">
<h3 class="anchored" data-anchor-id="why-the-claim-fails">Why the claim fails</h3>
<p>To demonstrate “rigging,” we would expect a clear statistical advantage for Democratic presidents in revision size or frequency. When revisions are examined by party, there is no consistent advantage. The long-run slight upward bias applies across parties and decades.</p>
</section>
<section id="conclusion-1" class="level3">
<h3 class="anchored" data-anchor-id="conclusion-1">Conclusion</h3>
<p>There is no empirical evidence that CES revisions systematically benefit Democrats. Revisions behave like a normal statistical correction process driven by economic volatility, seasonality, and data collection—not partisanship.</p>
<p><strong>PolitiFact Rating: Pants on Fire.</strong></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/Wanderloost\.github\.io\/STA9750-2025-FALL\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>